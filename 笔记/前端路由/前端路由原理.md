### hash路由和history API

当页面hash值改变会触发hashchange事件，而页面不会刷新

```javascript
window.addEventListener('hashchange', function() {
  console.log('The hash has changed!')
}, false);
```

改变hash的方式有两种：

1. 通过设置<a>标签的href属性

```html
<a href="#home">go home</a>
```

2. 设置location对象的hash属性

```javascript
location.hash = '#home'
```

hash有几个特性：

1. URL中的hash值是客户端的一种状态，当客户端向服务端发送请求时，hash部分不会被发送
2. hash值改变会在浏览器的访问历史中增加一个记录，我们可以通过前进后退控制hash的切换
3. 可以通过hashchange监听hash值的变化

### history API
###### history.pushState(state,title, url)        history.replaceState(state, title, url)
```javascript
history.pushState({}, null,'/home')
```
history.pushState方法会创建一个新的历史记录，并将一个state和这个历史记录关联起来。
history.replaceState方法和pushState方法类似，但是他会替换当前的历史记录。
关于传入方法的三个参数：state title url

- state：与对应历史记录关联的数据，可以是字符串、数组、数字、对象等。
- title：这个属性有些浏览器不支持，所以一般出入null
- url：新的历史记录的url地址，必须与原来的url是同源的。

### popstate事件

popstate事件在页面的url变化时触发，比如改变页面的hash值，或者调用history的`go`方法、`back`方法、`forward`方法，又或者点击浏览器的前进后退按钮。但是注意：调用pushState和replaceState方法不会触发popstate事件。

路由的实现：

![路由原理](E:\NodeJS-Study\笔记\前端路由\路由原理.png)







react-router通过forceUpdate的方式重新执行组件的render方法，如果当前url能和window.location.pathname匹配上，就返回对应的component，否则就返回null。



> 关于forceUpdate：
>
> forceUpdate是组件实例的方法，在组件内部可以通过this.forceUpdate调用，调用forceUpdate方法致使组件调用render方法，此操作会跳过该组件的shouldComponentUpdate，单其子组件正常触发生命周期。



















[参考资料](https://www.jianshu.com/p/d2aa8fb951e4)
